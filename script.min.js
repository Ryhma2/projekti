"use strict";function filterRestaurant(t){return t.address}var coordinates=[],getGoogleMapsLink=function(t){return console.log(t),'<a class="button" href="https://www.google.com/maps/dir//'+t.address+"?time="+Math.floor(Date.now()/1e3)+'"><i class="fab fa-google"></i></a>'},getHslLink=function(t){return console.log(t),'<a class="button bluebg" href="https://reittiopas.hsl.fi/reitti/'+coordinates.latitude+","+coordinates.longitude+"/"+t.address+"?time="+Math.floor(Date.now()/1e3)+'"><i class="fas fa-bus"></i></a>'},Location=function(t,e){e.flyTo({center:[t.coords.longitude,t.coords.latitude]}),coordinates=t.coords;var o=document.createElement("div");o.className="fa fa-map-marker red",new mapboxgl.Marker(o).setLngLat([t.coords.longitude,t.coords.latitude]).setPopup(new mapboxgl.Popup({offset:25}).setHTML("<h2>Sijaintisi</h2>")).addTo(e)};function getMenu(t){var e="";for(i=0;i<t.menuData.menus.length;i++)for(e+="<h3>"+t.menuData.menus[i].date+"</h3>",j=0;j<t.menuData.menus[i].data.length;j++)e+="<p>"+t.menuData.menus[i].data[j].name+"</p>",console.log(t.menuData.menus[i].data[j].name);document.querySelector("#data").innerHTML=e}!function(){mapboxgl.accessToken="pk.eyJ1Ijoib2JiMTIzIiwiYSI6ImNqdHBmY3U2ejAzczc0NGw1dmV0cmtkemcifQ.NYv9m8AnsqVHTop8Ay_k6w";var s=new mapboxgl.Map({container:"map",center:[25,60.2],zoom:12,style:"mapbox://styles/mapbox/streets-v11",pitchWithRotate:!1,dragRotate:!1,touchZoomRotate:!1});s.addControl(new mapboxgl.NavigationControl),s.dragRotate.disable(),s.touchZoomRotate.disableRotation(),Modernizr.geolocation&&navigator.geolocation.getCurrentPosition(function(t){Location(t,s)}),axios.get("https://unicafe.fi/wp-json/swiss/v1/restaurants?lang=fi").then(function(t){for(var i=t.data.filter(filterRestaurant),e=function(n){axios.get("https://api.digitransit.fi/geocoding/v1/search?text="+i[n].address+",Helsinki").then(function(t){console.log(t.data);var e=document.createElement("div");e.className="fa fa-map-marker",e.addEventListener("click",function(){getMenu(i[n])});var o=getHslLink(i[n]),a=getGoogleMapsLink(i[n]);new mapboxgl.Marker(e).setLngLat(t.data.features[0].geometry.coordinates).setPopup(new mapboxgl.Popup({offset:25}).setHTML("<h2>"+i[n].title+"</h2>"+o+a)).addTo(s)}).catch(function(t){console.log(t)})},o=0;o<=i.length;o++)e(o)}).catch(function(t){console.log(t)}).finally(function(){})}();
